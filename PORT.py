import base64
x = ( b'''IyMjIyMjIyMjIyMjIyMjCmltcG9ydCBvcwppbXBvcnQgc29ja2V0CmltcG9ydCBzeXMKZnJvbSB0aW1lIGltcG9ydCBzbGVlcCBhcyBzbGVlcApmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQojIyMjIyMjIyMjIyMjIyMjIyMjIwpkZWYgbG9nbygpOgogICBvcy5zeXN0ZW0gKCJjbGVhciAiKQogICBwcmludCgiXDAzM1sxOzMxbSBfX19fXyAgIF9fX19fICAgX19fX18gICAgX19fX18gICBfX19fXyAgIF9fX19fICAgICAgIF9fXyAgIF9fICAgXyAgIikKICAgc2xlZXAgKDAuMSkKICAgcHJpbnQoIlwwMzNbMTszMm18ICBfICBcIC8gIF8gIFwgfCAgXyAgXCAgfF8gICBffCAvICBfX18vIC8gIF9fX3wgICAgIC8gICB8IHwgIFwgfCB8ICIpCiAgIHNsZWVwICgwLjEpCiAgIHByaW50KCJcMDMzWzE7MzNtfCB8X3wgfCB8IHwgfCB8IHwgfF98IHwgICAgfCB8ICAgfCB8X19fICB8IHwgICAgICAgIC8gL3wgfCB8ICAgXHwgfCAiKQogICBzbGVlcCAoMC4xKQogICBwcmludCgiXDAzM1sxOzM1bXwgIF9fXy8gfCB8IHwgfCB8ICBfICAvICAgIHwgfCAgIFxfX18gIFwgfCB8ICAgICAgIC8gLyB8IHwgfCB8XCAgIHwgIikKICAgc2xlZXAgKDAuMSkKICAgcHJpbnQoIlwwMzNbMTszNm18IHwgICAgIHwgfF98IHwgfCB8IFwgXCAgICB8IHwgICAgX19ffCB8IHwgfF9fXyAgIC8gLyAgfCB8IHwgfCBcICB8ICIpCiAgIHNsZWVwICgwLjEpCiAgIHByaW50KCJcMDMzWzE7MzdtfF98ICAgICBcX19fX18vIHxffCAgXF9cICAgfF98ICAgL19fX19fLyBcX19fX198IC9fLyAgIHxffCB8X3wgIFxffCAiKQogICBzbGVlcCAoMC4xKQogICBwcmludCgiIikKICAgcHJpbnQoIgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcMDMzWzE7MzNtVmVyc2lvbj4+IDEiKQogICBwcmludCgiXDAzM1sxOzMxbT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09KCkoKSIpCiAgIHByaW50KCI9IikKbG9nbygpCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCnByaW50KCI9IDF9VXBkYXRlIikKcHJpbnQoIj0iKQpwcmludCgiPSAyfVBvcnQgU2NhbiIpCnByaW50KCI9IikKcHV0PWlucHV0KCI9LS0tLS0+KENob29zZSBhIE51bWJlciktLT4gIikKaWYgcHV0ID09IjEiOgogIG9zLnN5c3RlbSgiY2QgJiYgcm0gLXJpZiBQb3J0LVNjYW5uZXIgJiYgZ2l0IGNsb25lIGh0dHBzOi8vZ2l0aHViLmNvbS9NYXN0ZXJYQ29kZS9Qb3J0LVNjYW5uZXIgJiYgY2QgUG9ydC1TY2FubmVyICYmIHB5dGhvbiBQT1JULnB5IikKaWYgcHV0ID09IjIiOgogIGxvZ28oKQogIGlwPWlucHV0ICgiXDAzM1sxOzMzbT0tLS0tPihFblRlUiBBbiBJcCBUbyBTdEFyVCkgXDAzM1sxOzMxbcKwXyogXDAzM1sxOzMzbTogICIpCiAgdDE9ZGF0ZXRpbWUubm93KCkKICBwcmludCgiXDAzM1sxOzMxbVNjYW5uaW5nIFN0YXJ0Li4gJXMgUGxlYXNlIFdhaXQuLiAiJWlwKQogIHNsZWVwKDEpCiMjIyMjIyMjIyMjIyMjIyMjIyMjCiAgdHJ5OgogICAgICBmb3IgcG9ydCBpbiByYW5nZSgxLDY1NTMpOgogICAgICAgICAgcz1zb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULHNvY2tldC5TT0NLX1NUUkVBTSkKICAgICAgICAgIGlmKHMuY29ubmVjdF9leCgoaXAscG9ydCkpPT0wKToKICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgIHNlcnY9c29ja2V0LmdldHNlcnZieXBvcnQocG9ydCkKCiAgICAgICAgICAgICAgZXhjZXB0IHNvY2tldC5lcnJvcjoKICAgICAgICAgICAgICAgICAgc2Vydj0iVW5rbm93biBTZXJ2aWNlIgogICAgICAgICAgICAgIHByaW50ICgiUG9ydCAlcyBPcGVuIFNlcnZpY2U6JXMgIiUocG9ydCxzZXJ2KSkKICAgICAgICAgIHQyPWRhdGV0aW1lLm5vdygpCiAgICAgICAgICB0Mz10Mi10MQogICAgICBwcmludCAoIlwwMzNbMTszMW1TY2FubmluZyBDb21wbGV0ZWQgT24gJXMiJXQzKQogICAgICBwcmludCgiXDAzM1sxOzM3bSIpCiAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICBwcmludCgiXDAzM1sxOzM3bVNlZSBZb3UgU29vbi4uLi4hIikKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwo=''' )
exec (base64.b64decode(x))